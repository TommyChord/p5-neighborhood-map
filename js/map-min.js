function MyViewModel(){var e=this;e.mapOne=ko.observable({lat:ko.observable(63.427165),lng:ko.observable(10.396897)}),e.nameSearch=ko.observable(""),this.displayItemList=ko.observable(!1),e.toggleVisibility=function(){e.displayItemList(!e.displayItemList())},this.sightList=ko.observableArray([]),this.typeToShow=ko.observable("all"),this.filter=function(o,t){$(".menuIcon").removeClass("menuIconGlow"),$("#menu-btn-"+t).addClass("menuIconGlow"),e.typeToShow(o);var n=!1,i=new google.maps.LatLngBounds;e.sightList().forEach(function(t){0==e.nameSearch().length?"all"==o?(n=!0,t.marker().setVisible(!0),i.extend(t.marker().getPosition())):t.marker().category==o?(n=!0,t.marker().setVisible(!0),i.extend(t.marker().getPosition())):t.marker().setVisible(!1):"all"==o?-1!==t.name().toLowerCase().indexOf(e.nameSearch().toLowerCase())?(n=!0,t.marker().setVisible(!0),i.extend(t.marker().getPosition())):t.marker().setVisible(!1):-1!==t.name().toLowerCase().indexOf(e.nameSearch().toLowerCase())&&t.marker().category==o?(n=!0,t.marker().setVisible(!0),i.extend(t.marker().getPosition())):t.marker().setVisible(!1)}),n&&(e.mapOne().googleMap.fitBounds(i),e.mapOne().googleMap.setCenter(i.getCenter()),e.mapOne().googleMap.getZoom()>17&&e.mapOne().googleMap.setZoom(17))},this.categoriesToShow=ko.pureComputed(function(){var o=this.typeToShow(),t=!1,n=new google.maps.LatLngBounds;return"all"==o?0==e.nameSearch().length?(e.sightList().forEach(function(e){e.marker().setVisible(!0),t=!0,n.extend(e.marker().getPosition())}),e.mapOne().googleMap.fitBounds(n),e.mapOne().googleMap.setCenter(n.getCenter()),this.sightList()):ko.utils.arrayFilter(this.sightList(),function(o){return-1!==o.name().toLowerCase().indexOf(e.nameSearch().toLowerCase())?(o.marker().setVisible(!0),t=!0,n.extend(o.marker().getPosition())):o.marker().setVisible(!1),t&&(e.mapOne().googleMap.fitBounds(n),e.mapOne().googleMap.setCenter(n.getCenter()),e.mapOne().googleMap.getZoom()>17&&e.mapOne().googleMap.setZoom(17)),-1!==o.name().toLowerCase().indexOf(e.nameSearch().toLowerCase())}):ko.utils.arrayFilter(this.sightList(),function(i){return 0==e.nameSearch().length?(ko.unwrap(i.category)==o?(i.marker().setVisible(!0),t=!0,n.extend(i.marker().getPosition())):i.marker().setVisible(!1),t&&(e.mapOne().googleMap.fitBounds(n),e.mapOne().googleMap.setCenter(n.getCenter())),ko.unwrap(i.category)==o):(ko.unwrap(i.category)==o&&-1!==i.name().toLowerCase().indexOf(e.nameSearch().toLowerCase())?(i.marker().setVisible(!0),t=!0,n.extend(i.marker().getPosition())):i.marker().setVisible(!1),t&&(e.mapOne().googleMap.fitBounds(n),e.mapOne().googleMap.setCenter(n.getCenter()),e.mapOne().googleMap.getZoom()>17&&e.mapOne().googleMap.setZoom(17)),ko.unwrap(i.category)==o&&-1!==i.name().toLowerCase().indexOf(e.nameSearch().toLowerCase()))})},this),model.forEach(function(o){e.sightList.push(new Sight(o))}),this.currentSight=ko.observable(this.sightList()[0]),this.setCurrentSight=function(o){e.mapOne().googleMap.panTo(o.marker().getPosition()),o.marker().setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){o.marker().setAnimation(null)},2800)},this.typeToShow=ko.observable("all")}$(document).ready(function(){ko.applyBindings(viewModel)});var model=[{name:"Nidaros Cathedral",location:"Bispegata 11, 7012 Trondheim",url:"http://www.nidarosdomen.no/en-GB/",category:"churches",googleid:"ChIJGaAFhZAxbUYRxkoY_2IKIhY",yelpid:"nidarosdomen-trondheim",coordinate:{latitude:63.427165,longitude:10.396897}},{name:"Norwegian University of Science and Technology",location:"Høgskoleringen 1, 7034 Trondheim",url:"http://www.ntnu.edu/",category:"education",googleid:"ChIJf5PA2L8xbUYR5BBz-Uo49RA",yelpid:"ntnu-trondheim",coordinate:{latitude:63.419571,longitude:10.401875}},{name:"Rockheim",location:"Brattørkaia 14, 7010 Trondheim",url:"http://www.rockheim.no/english/",category:"museums",googleid:"ChIJ_SQZi50xbUYR2we35aFCaSU",yelpid:"rockheim-trondheim",coordinate:{latitude:63.438935,longitude:10.401295}},{name:"The Old City bridge",location:"Bubrua, 7013 Trondheim",url:"http://www.trondheim.no/content/631863/The-Old-Town-Bridge?language=3",category:"landmarks",googleid:"ChIJ-WYR7JkxbUYR_NxVgP6GCj0",yelpid:"gamle-bybro-trondheim",coordinate:{latitude:63.428206,longitude:10.401714}},{name:"Vår Frue kirke",location:"Vår Frue kirke, Kongens gate 5",url:"http://www.kirkesok.no/eng/kirker/Vaar-Frue-kirke-Trondheim",category:"churches",googleid:"ChIJEV4js5sxbUYRiqtUthnruQI",yelpid:"",coordinate:{latitude:63.430174,longitude:10.397476}},{name:"Trondheim United Methodist Church ",location:"Krambugata 6, 7406 Trondheim",url:"http://www.metodistkirken.no/trondheim/frame.php?page=64",category:"churches",googleid:"ChIJkYLe_JsxbUYR01OgR0YPJ1g",yelpid:"metodistkirken-i-norge-trondheim",coordinate:{latitude:63.43242,longitude:10.401274}},{name:"St. Olav Catholic Parish",location:"Schirmers gate 1, 7012 Trondheim",url:"http://trondheim.katolsk.no/en/home-page/",category:"churches",googleid:"ChIJo2JNV5AxbUYRJXYv-Nf9tmk",yelpid:"",coordinate:{latitude:63.425528,longitude:10.392551}},{name:"Salem Menighet",location:"Prinsens Gate 22B, 7012 Trondheim",url:"http://salemmenighet.no/",category:"churches",googleid:"ChIJdVZYwpoxbUYROLFU0BwyC-0",yelpid:"salem-menighet-normisjon-trondheim-trondheim",coordinate:{latitude:63.429804,longitude:10.392219}},{name:"Betel Pinsemenighet",location:"Prinsens Gate 10B, 7012 Trondheim",url:"http://www.beteltrondheim.no/",category:"churches",googleid:"ChIJ7aRzl5oxbUYR2gjvQFphqQw",yelpid:"pinsemenigheten-betel-trondheim-trondheim",coordinate:{latitude:63.428562,longitude:10.392251}},{name:"Trondheim Baptistmenighet",location:"Prinsens Gate 2D, 7012 Trondheim",url:"",category:"churches",googleid:"ChIJ31K3XpAxbUYRYA4EXhQ6Yqc",yelpid:"trondheim-baptistmenighet-trondheim",coordinate:{latitude:63.425927,longitude:10.392519}},{name:"Ilen kirke",location:"Ilen kirke, 7012 Trondheim",url:"http://www.kirkesok.no/eng/kirker/Ilen-kirke",category:"churches",googleid:"ChIJbTKKPYYxbUYR2BU32ovQx8s",yelpid:"",coordinate:{latitude:63.429992,longitude:10.376265}},{name:"Trondhjem Katedralskole",location:"Munkegata 8, 7013 Trondheim",url:"http://www.trondheim-katedral.vgs.no/",category:"education",googleid:"ChIJRQATZpoxbUYRAJLUokscE3M",yelpid:"trondheim-katedralskole-trondheim",coordinate:{latitude:63.428691,longitude:10.395716}},{name:"Sør-Trøndelag University College",location:"E. C. Dahls gate 2, 7012 Trondheim",url:"http://http://hist.no/english/",category:"education",googleid:"ChIJbQBLt5oxbUYRYxPfSlrS6aM",yelpid:"",coordinate:{latitude:63.429003,longitude:10.390888}},{name:"Vitensenteret i Trondheim",location:"Kongens gate 1, 7011 Trondheim",url:"http://www.vitensenteret.com/",category:"education",googleid:"ChIJQWdQ1ZsxbUYReHxtZZTBncE",yelpid:"vitensenteret-trondheim",coordinate:{latitude:63.43016,longitude:10.400834}},{name:"Birralee International school",location:"Bispegata 9, 7012 Trondheim",url:"http://birralee.no/",category:"education",googleid:"ChIJLTKoBZAxbUYR1a0_LVGMBOM",yelpid:"",coordinate:{latitude:63.427175,longitude:10.390663}},{name:"Trondheim International school",location:"Festningsgata 2, 7014 Trondheim",url:"http://this.no/",category:"education",googleid:"ChIJhdZiQqIxbUYRAVSYeTd5QHU",yelpid:"stiftelsen-trondheim-international-school-trondheim",coordinate:{latitude:63.429344,longitude:10.413644}},{name:"Folkeuniversitetet Midt-Norge",location:"Dronningens gate 10, 7011 Trondheim",url:"http://www.folkeuniversitetet.no/",category:"education",googleid:"ChIJFSvJ7ZsxbUYRe7vJH6zNDdw",yelpid:"folkeuniversitetet-midt-norge-trondheim",coordinate:{latitude:63.431993,longitude:10.399107}},{name:"NTNU Department of Music",location:"Kjøpmannsgata 48, 7010 Trondheim",url:"http://www.ntnu.edu/music",category:"education",googleid:"ChIJ-XPksJ4xbUYRD8V8USEX73Y",yelpid:"",coordinate:{latitude:63.433869,longitude:10.404106}},{name:"Ringve Music Museum",location:"Lade alle 60, 7041 Trondheim",url:"http://ringve.no/en/",category:"museums",googleid:"ChIJExGbthwxbUYRYY6srQ-FrY8",yelpid:"",coordinate:{latitude:63.447162,longitude:10.453395}},{name:"Sverresborg Trøndelag Folk Museum",location:"Sverresborg Alle 13, 7020 Trondheim",url:"http://sverresborg.no/english/",category:"museums",googleid:"ChIJo7QnxRgybUYRwIfYyYCMMys",yelpid:"sverresborg-trøndelag-folkemuseum-trondheim",coordinate:{latitude:63.421347,longitude:10.356814}},{name:"NTNU University Museum",location:"Erling Skakkes gate 47A, 7012 Trondheim",url:"http://www.ntnu.edu/museum",category:"museums",googleid:"ChIJR1lrRIUxbUYRFeJlMvS3n9A",yelpid:"",coordinate:{latitude:63.429113,longitude:10.387434}},{name:"Nordenfjeldske Kunstindustrimuseum",location:"Munkegata 3-7, 7013 Trondheim",url:"http://nkim.no/english/",category:"museums",googleid:"ChIJKRtLapoxbUYRl9eKvDq9t2Q",yelpid:"nordenfjeldske-kunstindustri-museum-trondheim",coordinate:{latitude:63.428701,longitude:10.396435}},{name:"Trondheim kunstmuseum",location:"Bispegata 7b, 7013 Trondheim",url:"http://trondheimkunstmuseum.no/en/",category:"museums",googleid:"ChIJaVGFgZAxbUYRmLY0McnGb0k",yelpid:"trondheim-kunstmuseum-trondheim",coordinate:{latitude:63.427482,longitude:10.394536}},{name:"The Jewish Museum Trondheim",location:"Arkitekt Christies gate 1, 7012 Trondheim",url:"http://jodiskemuseum.no/english/",category:"museums",googleid:"ChIJge7KZ5AxbUYRpt9V6VoT6dU",yelpid:"det-jødiske-museum-trondheim-trondheim",coordinate:{latitude:63.426416,longitude:10.392948}},{name:"The Norwegian National Museum of Justice",location:"Kongens gate 95, 7012 Trondheim",url:"http://norsk-rettsmuseum.no/english/",category:"museums",googleid:"ChIJUw2_DIYxbUYRWoLTYXpDXaQ",yelpid:"",coordinate:{latitude:63.430193,longitude:10.378357}},{name:"Archbishop's Palace",location:"Kongsgårds gate 1b, 7013 Trondheim",url:"http://www.nidarosdomen.no/en-GB/Articles/the+archbishops+palace.html",category:"landmarks",googleid:"ChIJRei0vpAxbUYRC3DvDFLTy8Y",yelpid:"",coordinate:{latitude:63.426109,longitude:10.395652}},{name:"Stiftsgården",location:"Munkegata 23, 7011 Trondheim",url:"http://www.royalcourt.no/artikkel.html?tid=28705&sek=28591",category:"landmarks",googleid:"ChIJXfOSDpsxbUYRN_VSe55u3qU",yelpid:"",coordinate:{latitude:63.43158,longitude:10.395137}},{name:"Scandic Nidelven",location:"Havnegata 1-3, 7010 Trondheim",url:"http://www.scandichotels.no/Hotels/Norge/Trondheim/Nidelven/#.VX9TomMhVZk",category:"restaurants",googleid:"ChIJo2ax9Z4xbUYRNq_f7CrwsNs",yelpid:"scandic-nidelven-trondheim",coordinate:{latitude:63.435582,longitude:10.406424}},{name:"Sesam",location:"Elgesetergate 1, 7030 Trondheim",url:"",category:"restaurants",googleid:"ChIJBxOYQ5ExbUYRj650KHMXwts",yelpid:"sesam-trondheim",coordinate:{latitude:63.422543,longitude:10.39488}},{name:"Baklandet Skydsstation",location:"Øvre Bakklandet 33, 7013 Trondheim",url:"http://www.skydsstation.no/",category:"restaurants",googleid:"ChIJqb152pkxbUYRPnGsWN9VfPQ",yelpid:"baklandet-skydsstation-trondheim-2",coordinate:{latitude:63.427412,longitude:10.403334}},{name:"Indian Tandoori Restaurant ",location:"Søndre gate 22A, 7010 Trondheim",url:"http://tandooritrondheim.no/",category:"restaurants",googleid:"ChIJ180zDJwxbUYRNxnVDuOpVXY",yelpid:"indian-tandoori-restaurant-trondheim",coordinate:{latitude:63.433744,longitude:10.400008}},{name:"Bryggen Asian Cooking",location:"Øvre Bakklandet 66, 7013 Trondheim",url:"http://www.bryggen.as/",category:"restaurants",googleid:"ChIJnSfpw5kxbUYRJ7nfmTLJvJ8",yelpid:"bryggen-asian-cooking-trondheim-2",coordinate:{latitude:63.427932,longitude:10.402677}},{name:"Kina Garden",location:"Gjelvangveita 2, 7010 Trondheim",url:"http://www.bryggen.as/",category:"restaurants",googleid:"ChIJa6Xhc5wxbUYRPCUvCtx6Xmw",yelpid:"kina-garden-trondheim",coordinate:{latitude:63.433661,longitude:10.39881}},{name:"To Rom og Kjøkken",location:"Carl Johans gate 5, 7010 Trondheim",url:"http://www.toromogkjokken.no/",category:"restaurants",googleid:"ChIJD_WLcZwxbUYRfOoISvT5WAc",yelpid:"to-rom-og-kjøkken-trondheim",coordinate:{latitude:63.433809,longitude:10.398774}}],Sight=function(e){this.name=ko.observable(e.name),this.location=ko.observable(e.location),this.url=ko.observable(e.url),this.category=ko.observable(e.category),this.googleid=ko.observable(e.googleid),this.yelpid=ko.observable(e.yelpid),this.latitude=ko.observable(e.coordinate.latitude),this.longitude=ko.observable(e.coordinate.longitude),this.marker=ko.observableArray([])};ko.bindingHandlers.map={init:function(e,o,t,n){var i=ko.utils.unwrapObservable(o()),a={panControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.LEFT_BOTTOM},streetViewControlOptions:{position:google.maps.ControlPosition.BOTTOM_CENTER}};i.googleMap=new google.maps.Map(e,a);var r=new google.maps.LatLngBounds;n.sightList().forEach(function(e){e.marker(new google.maps.Marker({map:i.googleMap,position:{lat:e.latitude(),lng:e.longitude()},title:e.name(),category:e.category()})),r.extend(e.marker().getPosition()),google.maps.event.addListener(e.marker(),"click",function(){var o={placeId:e.googleid()},t=new google.maps.places.PlacesService(i.googleMap),n=new google.maps.InfoWindow;t.getDetails(o,function(o,t){var a="";if(t==google.maps.places.PlacesServiceStatus.OK){if(a+=o.url?'<h1><a href="'+o.url+'" title="Open in Google Plus" target="Plus" class="link">'+e.name()+"</a></h1>":"<h1>"+e.name()+"</h1>",a+='<div class="row"><span class="label">Address: </span><span class="data">'+e.location()+"</span></div>",o.international_phone_number&&(a+='<div class="row"><span class="label">Phone: </span><span class="data">'+o.international_phone_number+"</span></div>"),o.opening_hours){var r=o.opening_hours.open_now?"Yes":"No";a+='<div class="row"><span class="label">Open Now: </span><span class="data">'+r+"</span></div>",a+='<div class="row"><span class="label">Opening Hours: </span><ol class="data-ol">',o.opening_hours.weekday_text.forEach(function(e){a+="<li>"+e+"</li>"}),a+="</ol></div>"}o.rating&&(a+='<div class="row"><span class="label">Rating: </span><span class="data">'+o.rating+"</span></div>")}e.url()&&(a+='<div class="row"><span class="label">Website: </span><span class="data"><a href="'+e.url()+'" target="P5-Link">'+e.url()+"</a></span></div>"),e.yelpid()&&getYelpData(e.yelpid(),function(e){n.setContent(n.getContent()+e.content)}),n.setContent(a),n.open(i.googleMap,e.marker())})})}),i.googleMap.fitBounds(r),i.googleMap.setCenter(r.getCenter()),$("#"+e.getAttribute("id")).data("mapObj",i)}},ko.bindingHandlers.fadeVisible={init:function(e,o){var t=o();$(e).toggle(ko.unwrap(t))},update:function(e,o){var t=o();ko.unwrap(t)?$(e).fadeIn(200):$(e).fadeOut(200)}};var viewModel=new MyViewModel;